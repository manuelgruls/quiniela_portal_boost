{"version":3,"file":"httpPostMessage.js","mappings":";CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,GACe,iBAAZC,QACdA,QAAQ,qBAAuBD,IAE/BD,EAAK,qBAAuBC,GAC7B,CATD,CASGK,MAAM,IACT,0HCQA,iBA6BE,WACEC,EACAC,EACAC,QADA,IAAAD,IAAAA,EAAA,IAGAE,KAAKF,eAAiBA,EACtBE,KAAKD,oBAAsBA,EAC3BC,KAAKH,uBAAyBA,CAChC,CA6EF,OA7GS,EAAAI,sBAAP,SAA6BC,EAAcC,GAKzC,OAJAD,EAAQE,QAAUF,EAAQE,SAAW,CAAC,EAClCD,GAAsBA,EAAmBE,KAC3CH,EAAQE,QAAQC,GAAKF,EAAmBE,IAEnCH,CACT,EACO,EAAAI,sBAAP,SAA6BJ,GAC3B,MAAO,CACLG,GAAIH,EAAQE,SAAWF,EAAQE,QAAQC,GAE3C,EACO,EAAAE,eAAP,SAAsBL,GACpB,MAA+C,iBAAnCA,GAAWA,EAAQM,eAItB,KAAON,EAAQM,YAAcN,EAAQM,WAAa,IAC7D,EAgBA,YAAAC,IAAA,SAAOC,EAAaN,EAAmBO,GACrC,YADkB,IAAAP,IAAAA,EAAA,SAAmB,IAAAO,IAAAA,EAAuBX,KAAKD,qBAC1DC,KAAKY,KAAQ,CAClBC,OAAQ,MACRH,IAAG,EACHN,QAAO,GACNO,EACL,EAEA,YAAAG,KAAA,SAAQJ,EAAaK,EAAWX,EAAmBO,GACjD,YAD8B,IAAAP,IAAAA,EAAA,SAAmB,IAAAO,IAAAA,EAAuBX,KAAKD,qBACtEC,KAAKY,KAAQ,CAClBC,OAAQ,OACRH,IAAG,EACHN,QAAO,EACPW,KAAI,GACHJ,EACL,EAEA,YAAAK,IAAA,SAAON,EAAaK,EAAWX,EAAmBO,GAChD,YAD6B,IAAAP,IAAAA,EAAA,SAAmB,IAAAO,IAAAA,EAAuBX,KAAKD,qBACrEC,KAAKY,KAAQ,CAClBC,OAAQ,MACRH,IAAG,EACHN,QAAO,EACPW,KAAI,GACHJ,EACL,EAEA,YAAAM,MAAA,SAASP,EAAaK,EAAWX,EAAmBO,GAClD,YAD+B,IAAAP,IAAAA,EAAA,SAAmB,IAAAO,IAAAA,EAAuBX,KAAKD,qBACvEC,KAAKY,KAAQ,CAClBC,OAAQ,QACRH,IAAG,EACHN,QAAO,EACPW,KAAI,GACHJ,EACL,EAEA,YAAAO,OAAA,SAAUR,EAAaK,EAAkBX,EAAmBO,GAC1D,YADqB,IAAAI,IAAAA,EAAA,WAAkB,IAAAX,IAAAA,EAAA,SAAmB,IAAAO,IAAAA,EAAuBX,KAAKD,qBAC/EC,KAAKY,KAAQ,CAClBC,OAAQ,SACRH,IAAG,EACHN,QAAO,EACPW,KAAI,GACHJ,EACL,EAEA,YAAAC,KAAA,SAAQO,EAAkCR,GAGxC,QAHwC,IAAAA,IAAAA,EAAuBX,KAAKD,qBACpEoB,EAAQf,QAAUJ,KAAKoB,OAAO,CAAC,EAAGpB,KAAKF,eAAgBqB,EAAQf,UAE1DO,EACH,MAAM,IAAIU,MAAM,2LAElB,OAAOrB,KAAKH,uBAAuByB,YAAYX,EAAcQ,EAC/D,EAMQ,YAAAC,OAAR,SAAeG,OAAa,wDAC1B,GAAIA,QACF,MAAM,IAAIC,UAAU,8CAGtB,IAAMC,EAASC,OAAOH,GAWtB,OAVAI,EAAQC,SAAQ,SAAAC,GACd,GAAIA,QACF,IAAK,IAAIC,KAAWD,EACdH,OAAOK,UAAUC,eAAeC,KAAKJ,EAAQC,KAC/CL,EAAOK,GAAWD,EAAOC,GAIjC,IAEOL,CACT,EACF,EAlHA,GAAa,EAAAS,gBAAAA,SDRb","sources":["webpack://http-post-message/webpack/universalModuleDefinition","webpack://http-post-message/./src/httpPostMessage.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"http-post-message\"] = factory();\n\telse\n\t\troot[\"http-post-message\"] = factory();\n})(self, () => {\nreturn ","export interface IHttpPostMessageRequest {\r\n  method: \"GET\" | \"POST\" | \"PUT\" | \"PATCH\" | \"DELETE\";\r\n  url: string;\r\n  headers: any;\r\n  body?: any;\r\n}\r\n\r\nexport interface IHttpPostMessageResponse<T> {\r\n  statusCode: number;\r\n  statusText: string;\r\n  headers: any;\r\n  body: T;\r\n}\r\n\r\nexport interface IPostMessage {\r\n  postMessage<T>(window: Window, message: any): Promise<T>;\r\n}\r\n\r\nexport class HttpPostMessage {\r\n  // TODO: See if it's possible to share tracking properties interface?\r\n  // The responsibility of knowing how to configure windowPostMessageProxy for http should\r\n  // live in this http class, but the configuration would need ITrackingProperties\r\n  // interface which lives in WindowPostMessageProxy. Use <any> type as workaround\r\n  static addTrackingProperties(message: any, trackingProperties: any): any {\r\n    message.headers = message.headers || {};\r\n    if (trackingProperties && trackingProperties.id) {\r\n      message.headers.id = trackingProperties.id;\r\n    }\r\n    return message;\r\n  }\r\n  static getTrackingProperties(message: any): any {\r\n    return {\r\n      id: message.headers && message.headers.id\r\n    };\r\n  }\r\n  static isErrorMessage(message: any): boolean {\r\n    if (typeof (message && message.statusCode) !== 'number') {\r\n      return false;\r\n    }\r\n\r\n    return !(200 <= message.statusCode && message.statusCode < 300);\r\n  }\r\n\r\n  defaultHeaders: any;\r\n  defaultTargetWindow: Window;\r\n  windowPostMessageProxy: IPostMessage;\r\n\r\n  constructor(\r\n    windowPostMessageProxy: IPostMessage,\r\n    defaultHeaders: any = {},\r\n    defaultTargetWindow?: Window\r\n  ) {\r\n    this.defaultHeaders = defaultHeaders;\r\n    this.defaultTargetWindow = defaultTargetWindow;\r\n    this.windowPostMessageProxy = windowPostMessageProxy;\r\n  }\r\n\r\n  get<T>(url: string, headers: any = {}, targetWindow: Window = this.defaultTargetWindow) {\r\n    return this.send<T>({\r\n      method: \"GET\",\r\n      url,\r\n      headers\r\n    }, targetWindow);\r\n  }\r\n\r\n  post<T>(url: string, body: any, headers: any = {}, targetWindow: Window = this.defaultTargetWindow) {\r\n    return this.send<T>({\r\n      method: \"POST\",\r\n      url,\r\n      headers,\r\n      body\r\n    }, targetWindow);\r\n  }\r\n\r\n  put<T>(url: string, body: any, headers: any = {}, targetWindow: Window = this.defaultTargetWindow) {\r\n    return this.send<T>({\r\n      method: \"PUT\",\r\n      url,\r\n      headers,\r\n      body\r\n    }, targetWindow);\r\n  }\r\n\r\n  patch<T>(url: string, body: any, headers: any = {}, targetWindow: Window = this.defaultTargetWindow) {\r\n    return this.send<T>({\r\n      method: \"PATCH\",\r\n      url,\r\n      headers,\r\n      body\r\n    }, targetWindow);\r\n  }\r\n\r\n  delete<T>(url: string, body: any = null, headers: any = {}, targetWindow: Window = this.defaultTargetWindow) {\r\n    return this.send<T>({\r\n      method: \"DELETE\",\r\n      url,\r\n      headers,\r\n      body\r\n    }, targetWindow);\r\n  }\r\n\r\n  send<T>(request: IHttpPostMessageRequest, targetWindow: Window = this.defaultTargetWindow): Promise<IHttpPostMessageResponse<T>> {\r\n    request.headers = this.assign({}, this.defaultHeaders, request.headers);\r\n\r\n    if (!targetWindow) {\r\n      throw new Error(`target window is not provided.  You must either provide the target window explicitly as argument to request, or specify default target window when constructing instance of this class.`);\r\n    }\r\n    return this.windowPostMessageProxy.postMessage(targetWindow, request);\r\n  }\r\n\r\n  /**\r\n   * Object.assign() polyfill\r\n   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\r\n   */\r\n  private assign(target: any, ...sources: any[]): any {\r\n    if (target === undefined || target === null) {\r\n      throw new TypeError('Cannot convert undefined or null to object');\r\n    }\r\n\r\n    const output = Object(target);\r\n    sources.forEach(source => {\r\n      if (source !== undefined && source !== null) {\r\n        for (var nextKey in source) { /* eslint-disable-line */\r\n          if (Object.prototype.hasOwnProperty.call(source, nextKey)) {\r\n            output[nextKey] = source[nextKey];\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    return output;\r\n  }\r\n}\r\n"],"names":["root","factory","exports","module","define","amd","self","windowPostMessageProxy","defaultHeaders","defaultTargetWindow","this","addTrackingProperties","message","trackingProperties","headers","id","getTrackingProperties","isErrorMessage","statusCode","get","url","targetWindow","send","method","post","body","put","patch","delete","request","assign","Error","postMessage","target","TypeError","output","Object","sources","forEach","source","nextKey","prototype","hasOwnProperty","call","HttpPostMessage"],"sourceRoot":""}